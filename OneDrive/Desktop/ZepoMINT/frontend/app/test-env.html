<!DOCTYPE html>
<html>
<head>
    <title>Environment Variable Test</title>
</head>
<body>
    <h1>Environment Variable Test</h1>
    <div id="results"></div>
    
    <script type="module">
        // Test environment variables
        const results = document.getElementById('results');
        
        const envVars = {
            'VITE_RELAYER_URL': import.meta.env.VITE_RELAYER_URL,
            'VITE_KMS_VERIFIER_CONTRACT': import.meta.env.VITE_KMS_VERIFIER_CONTRACT,
            'VITE_INPUT_VERIFIER_CONTRACT': import.meta.env.VITE_INPUT_VERIFIER_CONTRACT,
            'VITE_INPUT_VERIFICATION_CONTRACT': import.meta.env.VITE_INPUT_VERIFICATION_CONTRACT,
            'VITE_ACL_CONTRACT': import.meta.env.VITE_ACL_CONTRACT,
            'VITE_DECRYPTION_ORACLE_CONTRACT': import.meta.env.VITE_DECRYPTION_ORACLE_CONTRACT
        };
        
        let html = '<h2>Environment Variables:</h2><ul>';
        for (const [key, value] of Object.entries(envVars)) {
            html += `<li><strong>${key}:</strong> ${value || '<span style="color: red;">UNDEFINED</span>'}</li>`;
        }
        html += '</ul>';
        
        // Test relayer connection
        html += '<h2>Relayer Test:</h2>';
        if (import.meta.env.VITE_RELAYER_URL) {
            html += `<p>Testing connection to: ${import.meta.env.VITE_RELAYER_URL}/v1/keyurl</p>`;
            html += '<div id="relayer-result">Testing...</div>';
            
            // Test the relayer endpoint
            fetch(`${import.meta.env.VITE_RELAYER_URL}/v1/keyurl`)
                .then(response => {
                    document.getElementById('relayer-result').innerHTML = 
                        `<p>Status: ${response.status} ${response.statusText}</p>`;
                    return response.text();
                })
                .then(text => {
                    try {
                        const json = JSON.parse(text);
                        document.getElementById('relayer-result').innerHTML += 
                            `<pre>${JSON.stringify(json, null, 2)}</pre>`;
                    } catch (e) {
                        document.getElementById('relayer-result').innerHTML += 
                            `<p>Response (not JSON): ${text.substring(0, 200)}...</p>`;
                    }
                })
                .catch(error => {
                    document.getElementById('relayer-result').innerHTML = 
                        `<p style="color: red;">Error: ${error.message}</p>`;
                });
        } else {
            html += '<p style="color: red;">VITE_RELAYER_URL is not defined!</p>';
        }
        
        results.innerHTML = html;
    </script>
</body>
</html>